# on master 
apt install vim curl wget ssh -y 
apt-get update -y
apt-get upgrade -y
cat /etc/lsb-release
apt-get install gnupg curl
curl -fsSL https://www.mongodb.org/static/pgp/server-8.0.asc |    sudo gpg -o /usr/share/keyrings/mongodb-server-8.0.gpg    --dearmor
echo "deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-8.0.gpg ] https://repo.mongodb.org/apt/ubuntu noble/mongodb-org/8.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-8.0.list
apt-get update
apt-get install -y mongodb-org
systemctl start mongod
systemctl enable mongod
systemctl status mongod
wget https://downloads.mongodb.com/compass/mongodb-compass_1.46.8_amd64.deb
dpkg -i mongodb-compass_1.46.8_amd64.deb 
systemctl status mongod.service 
vi /etc/mongod.conf
systemctl restart mongod
sudo ufw allow 27017/tcp
vi /etc/mongod.conf 
##master node conf
cat /etc/mongod.conf 
# mongod.conf
# for documentation of all options, see:
#   http://docs.mongodb.org/manual/reference/configuration-options/
# Where and how to store data.
storage:
  dbPath: /var/lib/mongodb
#  engine:
#  wiredTiger:
# where to write logging data.
systemLog:
  destination: file
  logAppend: true
  path: /var/log/mongodb/mongod.log
# network interfaces
net:
  port: 27017
  bindIp: 0.0.0.0
# how the process runs
processManagement:
  timeZoneInfo: /usr/share/zoneinfo
#security:
#operationProfiling:
replication:
  replSetName: "rs0"
#sharding:
## Enterprise-Only Options:
#auditLog:
security:
  authorization: disabled
###
systemctl enable mongod
systemctl restart mongod
ufw allow 27017/tcp    # firewall open karo
systemctl enable mongod
systemctl restart mongod
ufw allow 27017/tcp    # firewall open karo
  mongosh
## add this inside mongosh terminal
rs.initiate({
  _id: "rs0",
  members: [
    { _id: 0, host: "192.168.163.128:27017" },
    { _id: 1, host: "192.168.163.130:27017" }
  ]
})
rs.status()
##
Test Replication
Insert data in primary:
use testDB
db.testCollection.insert({name:"Rameshwar"})

Secondary VM pe connect aur check karo:

mongosh --host VM2_IP
use testDB
db.testCollection.find()
####################################
ðŸ’¡ Tip: Agar aap pehli baar try kar rahe ho aur kuch partial set initiate hua hai, pehle reset karo:
rs.remove("192.168.163.130:27017")
Phir dobara add karo:
rs.add("192.168.163.130:27017")
